!function(i,e){"use strict";function o(e){this.vars.map&&this.vars.map.setOptions({scrollwheel:e})}function l(){var e=this;this.vars.map.addListener("zoom_changed",function(){e.vars.zoomchanged=e.vars.map.getZoom()})}var r="gmap",n=i("body"),s=i(e),t=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"geometry.stroke",stylers:[{lightness:"1"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit.station.bus",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"transit.station.bus",elementType:"labels.text.fill",stylers:[{saturation:"0"},{lightness:"0"},{gamma:"1.00"},{weight:"1"}]},{featureType:"transit.station.bus",elementType:"labels.icon",stylers:[{saturation:"-100"},{weight:"1"},{lightness:"0"}]},{featureType:"transit.station.rail",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"transit.station.rail",elementType:"labels.text.fill",stylers:[{gamma:"1"},{lightness:"40"}]},{featureType:"transit.station.rail",elementType:"labels.icon",stylers:[{saturation:"-100"},{lightness:"30"}]}];function a(e,t){this.element=i(e),this.options=i.extend({},i.fn[r].defaults,this.element.data(),t,this.element.data(r)),this.init()}a.prototype={init:function(){this.vars={},this.vars.marker=[],this.vars.locations=locations,this.vars.optMap={center:{lat:this.vars.locations[0].lat,lng:this.vars.locations[0].lng},zoom:this.options.zoom[0],styles:t,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.DEFAULT,position:google.maps.ControlPosition.RIGHT_CENTER},panControl:!1,scrollwheel:!1,gestureHandling:"cooperative"},this.initGmap()},initGmap:function(){this.vars.map=new google.maps.Map(document.getElementById(this.options.id),this.vars.optMap),this.setMarkers(),this.listener()},listener:function(){(function(){var t=this;google.maps.event.addDomListener(document.getElementById(this.options.id),"click",function(){o.call(t,!0)}),google.maps.event.addDomListener(document.getElementById(this.options.id).childNodes,"click",function(){o.call(t,!0)}),google.maps.event.addListener(t.vars.map,"mousedown",function(){o.call(t,!0)}),n.on("mousedown."+r,function(e){i(e.target).closest("#"+t.options.id).length||o.call(t,!1)}),s.on("scroll."+r,function(){o.call(t,!1)})}).call(this),function(){var t,a,i=this,e=document.getElementById(this.options.input);e&&(t=new google.maps.places.SearchBox(e),this.vars.map.controls[google.maps.ControlPosition.TOP_LEFT].push(e),this.vars.map.addListener("bounds_changed",function(){t.setBounds(i.vars.map.getBounds())}),a=[],t.addListener("places_changed",function(){var n,e=t.getPlaces(),s=new google.maps.LatLngBounds;0!==e.length&&(a.forEach(function(e){e.setMap(null)}),a=[],e.forEach(function(e,t){var o;e.geometry?(o={url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchoPoint:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},a.push(new google.maps.Marker({map:i.vars.map,icon:o,title:e.name,position:e.geometry.location})),n='<strong style="display: block; text-align: center;">'+e.name+"</strong>"+e.formatted_address,google.maps.event.addListener(a[t],"click",function(){i.setCenter(a[t]),i.showInfoWindow(a[t],'<div class="noscrollbar">'+n+"</>")}),e.geometry.viewport?s.union(e.geometry.viewport):s.extend(e.geometry.location)):console.log("Returned place contains no geometry")}),l.call(i),i.vars.map.fitBounds(s))}))}.call(this),this.changeLocation(this.vars.locations,this.options.initValue)},setMarkers:function(){var e,o=this;this.vars.bound=new google.maps.LatLngBounds,this.vars.infowindow=new google.maps.InfoWindow;for(var t=0,n=this.vars.locations.length;t<n;++t)o.vars.icon={url:o.vars.locations[t].marker||o.options.icon},this.vars.bound.extend(new google.maps.LatLng(o.vars.locations[t].lat,o.vars.locations[t].lng)),e=new google.maps.LatLng(o.vars.locations[t].lat,o.vars.locations[t].lng),o.vars.marker[t]=new google.maps.Marker({position:e,title:o.vars.locations[t].name,map:o.vars.map,icon:o.vars.icon,animation:google.maps.Animation.DROP}),google.maps.event.addListener(o.vars.marker[t],"click",function(e,t){return function(){l.call(o),o.setCenter(e),o.showInfoWindow(e,t),i("#"+o.options.dropdown).val(e.title),i("#"+o.options.dropdown).closest("[data-select]").addClass("selected").find("span").html(e.title)}}(o.vars.marker[t],this.vars.locations[t].mess));this.boundAllPosition()},boundAllPosition:function(){this.vars.map.setCenter(this.vars.bound.getCenter()),this.vars.map.fitBounds(this.vars.bound)},changeLocation:function(e,t){for(var n=this,o="",s=0,a=e.length;s<a;++s)o=t===e[s].name?'<option value="'+e[s].name+'" selected="selected">'+e[s].name+"</option>":'<option value="'+e[s].name+'">'+e[s].name+"</option>",i("#"+this.options.dropdown).append(o);i("#"+this.options.dropdown).on("change."+r,function(){for(var e=i(this).val(),t=0,o=n.vars.locations.length;t<o;++t)e===n.vars.locations[t].name&&google.maps.event.trigger(n.vars.marker[t],"click");e||(n.boundAllPosition(),n.vars.infowindow.close(),n.vars.zoomchanged=void 0)}),google.maps.event.addListenerOnce(this.vars.map,"idle",function(){i("#"+n.options.dropdown).change()})},setCenter:function(e){var t=this.options.zoom[1];this.vars.zoomchanged&&(t=this.vars.zoomchanged),this.vars.map.setZoom(t),this.vars.map.panTo(e.getPosition())},showInfoWindow:function(e,t){this.vars.infowindow.setContent(t),this.vars.infowindow.open(this.vars.map,e)}},i.fn[r]=function(t,o){return this.each(function(){var e=i.data(this,r);e?e[t]&&e[t](o):i.data(this,r,new a(this,t))})},i.fn[r].defaults={},i(function(){i("[data-gmap]")[r]({icon:"//chinhphan099.github.io/blogger-assets/images/common/pink-marker.png"})})}(jQuery,window);
